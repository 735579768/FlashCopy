!function(e){"use strict";var t={ish5:function(){return!!document.execCommand}(),alias:"FlashCopy",movieId:"flashcopyid",swfpath:function(){var e=document.scripts,t=e[e.length-1],o=t.src;return o.substring(0,o.lastIndexOf("/")+1)}()+"flashcopy.swf",swfobj:null,divswf:null,ready:!1,activeDom:null,$:function(e){return"string"==typeof e?document.getElementById(e):e},addClass:function(e,t){this.removeClass(e,t),e.className+=" "+t},removeClass:function(e,t){for(var o=e.className.split(/\s+/),s=-1,i=0;i<o.length;i++)o[i]==t&&(s=i,i=o.length);return s>-1&&(o.splice(s,1),e.className=o.join(" ")),e},hasClass:function(e,t){return!!e.className.match(new RegExp("\\s*"+t+"\\s*"))},setCopy:function(e){var t=this,o=t.$(e.domid);return o?(o.prototype={getCopyText:e.getCopyText,copySuccess:e.copySuccess,copyFail:e.copyFail},t.ish5?(o.onclick=function(){var e=o.prototype.getCopyText(o),s=t.copyTextToClipboard(e);s?"function"==typeof o.prototype.copySuccess&&o.prototype.copySuccess(o,e):"function"==typeof o.prototype.copyFail&&o.prototype.copyFail(o,e)},!0):(t.initSwf(o),o.style.position="relative",void function(){var e=t,s=o;s.onmouseover=function(){e.activeDom=s,e.reposition(s)}}())):!1},getObjRect:function(e){return this.$(e).getBoundingClientRect()},getScrollTop:function(){var e=0;return document.documentElement&&document.documentElement.scrollTop?e=document.documentElement.scrollTop:document.body&&(e=document.body.scrollTop),e},getWH:function(e){return{width:e.width?e.width:e.offsetWidth,height:e.height?e.height:e.offsetHeight}},initSwf:function(e){var t=this;if(!t.divswf){var o=9999999999999,s=document.createElement("div");s.className="zclip",s.id="flashcopyzclip",s.style.cssText="display:block;top:-10000000px;position:absolute;left:-100000px;cursor:pointer;z-index:"+o,document.getElementsByTagName("body")[0].appendChild(s),t.divswf=s;var i=t.getWH(e);this.divswf.innerHTML=this.getSwfHTML(i.width,i.height),this.swfobj=t.$(t.movieId)}},getSwfHTML:function(e,t){var o="",s="id=0&width="+e+"&height="+t+"&alias="+this.alias;if(navigator.userAgent.match(/MSIE/)){var i=location.href.match(/^https/i)?"https://":"http://";o+='<object style="vertical-align: top;"  classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="'+i+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" width="'+e+'" height="'+t+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+this.swfpath+"?"+Math.random()+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+s+'"/><param name="wmode" value="transparent"/></object>'}else o+='<embed style="vertical-align: top;" id="'+this.movieId+'" src="'+this.swfpath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+e+'" height="'+t+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+s+'" wmode="transparent" />';return o},reposition:function(e){var t=this.getWH(e),o=this.getObjRect(e);this.divswf.style.left=o.left+"px",this.divswf.style.top=o.top+this.getScrollTop()+"px",this.setSize(t.width,t.height)},setSize:function(e,t){this.divswf.style.width=e+"px",this.divswf.style.height=t+"px",this.divswf.style.display="block",this.swfobj.width=e,this.swfobj.height=t,"function"==typeof this.swfobj.setSwfSize&&this.swfobj.setSwfSize(e,t)},dispatch:function(e,t){this.receiveEvent(e,t)},receiveEvent:function(e,t){switch(e=e.toString().toLowerCase().replace(/^on/,"")){case"load":if(!this.swfobj){var o=this;return void setTimeout(function(){o.receiveEvent("load",null)},1)}if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/)){var o=this;return setTimeout(function(){o.receiveEvent("load",null)},100),void(this.ready=!0)}this.ready=!0;break;case"mousedown":this.ready&&("undefined"==typeof this.swfobj.setText||this.swfobj.setText(this.activeDom.prototype.getCopyText(this.activeDom)));break;case"mousemove":break;case"mouseover":this.addClass(this.activeDom,"hover");break;case"mouseout":this.removeClass(this.activeDom,"hover");break;case"complete":this.activeDom.prototype.copySuccess(this.activeDom,t)}},copyTextToClipboard:function(e){var t=document.createElement("textarea");t.style.position="fixed",t.style.top=0,t.style.left=0,t.style.width="2em",t.style.height="2em",t.style.padding=0,t.style.border="none",t.style.outline="none",t.style.boxShadow="none",t.style.background="transparent",t.value=e,document.body.appendChild(t),t.select();try{var o=document.execCommand("copy");return document.body.removeChild(t),o}catch(s){return document.body.removeChild(t),alert("不能使用这种方法复制内容"),!1}}};e.FlashCopy=t}(window);